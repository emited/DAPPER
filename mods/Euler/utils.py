from collections import OrderedDict
import time

def generate_header(content):
	'''be careful, the order in the header counts!'''

	header = OrderedDict([
		('dimX', 64),
		('dimY', 64),
		('dimZ', 1),
	])

	# check if density or velocity
	if content.shape[3] == 1: # density
		header['gridType'] = 1
		header['elementType'] = 1
		header['bytesPerElement'] = 4
		header['info'] = b'mantaflow 0.12 64bit fp1 omp commit 15eaf4aa72da62e174df6c01f85ccd66fde20acc from Aug 14 2018, 15:47:38\x00`\xb6a]0\x7f\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x90\xb1PI0\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\na]0\x7f\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00 \x00\x00\x000\x00\x00\x00\x90\xb2PI0\x7f\x00\x00\xd0\xb1PI0\x7f\x00\x00\x10\xb6PI0\x7f\x00\x00\x1a\x00\x00\x00\x00\x00\x00\x000\xbd\x86I0\x7f\x00\x00\x10\xb6PI0\x7f\x00\x00\xf0\xb5PI0\x7f\x00\x00\xf0\xb5PI0\x7f\x00\x00\x1b\x00\x00\x00\x00\x00\x00\x00 \xb6PI'
	elif content.shape[3] == 3: # velocity
		header['gridType'] = 12
		header['elementType'] = 2
		header['bytesPerElement'] = 12
		header['info'] = b'mantaflow 0.12 64bit fp1 omp commit 15eaf4aa72da62e174df6c01f85ccd66fde20acc from Aug 14 2018, 15:47:38\x00\x90\xb2PI0\x7f\x00\x00\xf8\x8e\x0eP0\x7f\x00\x00\n\x00\x00\x00\x00\x00\x00\x00f\x8b:]0\x7f\x00\x00@\xb6PI0\x7f\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\xb0\xb1PI0\x7f\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00 \x00\x00\x000\x00\x00\x00\x90\xb2PI0\x7f\x00\x00\xd0\xb1PI0\x7f\x00\x00\x10\xb6PI0\x7f\x00\x00\x16\x00\x00\x00\x00\x00\x00\x00\x00\x068*0\x7f\x00\x00\x10\xb6PI0\x7f\x00\x00\xf0\xb5PI0\x7f\x00\x00\xf0\xb5PI0\x7f\x00\x00\x17\x00\x00\x00\x00\x00\x00\x00 \xb6PI'
	else:
		raise NotImplementedError(
			'Does not correspond to density or velocity'
		)
		
	header['dimT'] = 0
	header['timestamp'] = int(time.time())


	return header